---
title: 'Health Check'
api: 'GET /health'
description: 'Check if the API server is running and healthy'
---

## Overview

Simple health check endpoint to verify the API server is operational and properly configured.

## Response

<ResponseField name="status" type="string">
  Server health status. Will be "healthy" if operational.
</ResponseField>

<ResponseField name="timestamp" type="string">
  ISO 8601 timestamp of when the health check was performed
</ResponseField>

<ResponseField name="activeSessions" type="number">
  Number of bridge sessions currently stored in memory
</ResponseField>

<ResponseField name="fundingWalletConfigured" type="boolean">
  Whether the funding wallet is properly configured (CUSTOMWALLET environment variable set)
</ResponseField>

<RequestExample>

```bash cURL
curl https://stable-flow-backend.onrender.com/health
```

```javascript JavaScript
const response = await fetch('https://stable-flow-backend.onrender.com/health');
const health = await response.json();
console.log('Server status:', health.status);
```

```python Python
import requests

response = requests.get('https://stable-flow-backend.onrender.com/health')
health = response.json()
print(f"Server status: {health['status']}")
```

</RequestExample>

<ResponseExample>

```json Healthy Response
{
  "status": "healthy",
  "timestamp": "2025-01-23T10:30:00.000Z",
  "activeSessions": 5,
  "fundingWalletConfigured": true
}
```

```json Not Configured
{
  "status": "healthy",
  "timestamp": "2025-01-23T10:30:00.000Z",
  "activeSessions": 0,
  "fundingWalletConfigured": false
}
```

</ResponseExample>

## Use Cases

### Monitoring and Uptime Checks

Use this endpoint for automated monitoring:

```javascript
// Simple uptime check
async function checkHealth() {
  try {
    const response = await fetch('https://stable-flow-backend.onrender.com/health', {
      timeout: 5000 // 5 second timeout
    });
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }
    
    const health = await response.json();
    
    if (health.status !== 'healthy') {
      throw new Error(`Unhealthy status: ${health.status}`);
    }
    
    return {
      healthy: true,
      ...health
    };
  } catch (error) {
    return {
      healthy: false,
      error: error.message
    };
  }
}

// Use in monitoring system
setInterval(async () => {
  const health = await checkHealth();
  if (!health.healthy) {
    console.error('API is down!', health.error);
    // Send alert
  }
}, 60000); // Check every minute
```

### Configuration Verification

Verify the server is properly configured before use:

```python
import requests
import sys

def verify_configuration():
    try:
        response = requests.get('https://stable-flow-backend.onrender.com/health', timeout=5)
        health = response.json()
        
        if health['status'] != 'healthy':
            print(f"❌ Server is not healthy: {health['status']}")
            return False
        
        if not health['fundingWalletConfigured']:
            print("⚠️  Warning: Funding wallet not configured")
            print("   Set CUSTOMWALLET environment variable")
            return False
        
        print("✅ Server is healthy and properly configured")
        print(f"   Active sessions: {health['activeSessions']}")
        return True
        
    except Exception as e:
        print(f"❌ Failed to connect to server: {e}")
        return False

if __name__ == '__main__':
    if not verify_configuration():
        sys.exit(1)
```

### Load Balancer Health Checks

Configure your load balancer to use this endpoint:

```yaml
# Example Kubernetes liveness probe
livenessProbe:
  httpGet:
    path: /health
    port: 3000
  initialDelaySeconds: 10
  periodSeconds: 30
  
readinessProbe:
  httpGet:
    path: /health
    port: 3000
  initialDelaySeconds: 5
  periodSeconds: 10
```

### Comprehensive Health Dashboard

```javascript
class HealthDashboard {
  constructor(apiUrl) {
    this.apiUrl = apiUrl;
  }
  
  async getDetailedHealth() {
    const response = await fetch(`${this.apiUrl}/health`);
    const health = await response.json();
    
    // Get additional metrics
    const sessionsResponse = await fetch(`${this.apiUrl}/bridge/sessions`);
    const sessions = await sessionsResponse.json();
    
    return {
      ...health,
      sessionBreakdown: {
        pending: sessions.sessions.filter(s => s.status === 'pending_deposit').length,
        processing: sessions.sessions.filter(s => s.status === 'processing').length,
        completed: sessions.sessions.filter(s => s.status === 'completed').length,
        failed: sessions.sessions.filter(s => s.status === 'failed').length
      },
      uptime: this.calculateUptime(health.timestamp)
    };
  }
  
  calculateUptime(timestamp) {
    // Implement based on your needs
    return 'N/A';
  }
  
  async printHealth() {
    const health = await this.getDetailedHealth();
    
    console.log('=== API Health Dashboard ===');
    console.log(`Status: ${health.status}`);
    console.log(`Timestamp: ${health.timestamp}`);
    console.log(`Funding Wallet: ${health.fundingWalletConfigured ? '✅ Configured' : '❌ Not Configured'}`);
    console.log(`\nActive Sessions: ${health.activeSessions}`);
    console.log('  Pending:', health.sessionBreakdown.pending);
    console.log('  Processing:', health.sessionBreakdown.processing);
    console.log('  Completed:', health.sessionBreakdown.completed);
    console.log('  Failed:', health.sessionBreakdown.failed);
  }
}

// Usage
const dashboard = new HealthDashboard('https://stable-flow-backend.onrender.com');
await dashboard.printHealth();
```

## Monitoring Best Practices

<AccordionGroup>
  <Accordion title="Uptime Monitoring" icon="chart-line">
    - Poll every 30-60 seconds
    - Alert if 3 consecutive failures
    - Track uptime percentage over time
  </Accordion>
  
  <Accordion title="Configuration Checks" icon="gear">
    - Verify `fundingWalletConfigured` is true
    - Alert if funding wallet becomes unconfigured
    - Check before running bridge operations
  </Accordion>
  
  <Accordion title="Session Monitoring" icon="list">
    - Track growth rate of `activeSessions`
    - Alert if sessions grow too quickly (potential attack)
    - Monitor for stuck sessions
  </Accordion>
  
  <Accordion title="Response Time" icon="clock">
    - Track response time of health endpoint
    - Alert if response time > 5 seconds
    - Use as early warning for performance issues
  </Accordion>
</AccordionGroup>

## Integration Examples

### Prometheus Metrics

Convert health data to Prometheus format:

```javascript
app.get('/metrics', async (req, res) => {
  const healthResponse = await fetch('https://stable-flow-backend.onrender.com/health');
  const health = await healthResponse.json();
  
  const sessionsResponse = await fetch('https://stable-flow-backend.onrender.com/bridge/sessions');
  const sessions = await sessionsResponse.json();
  
  const metrics = `
# HELP bridge_api_healthy Server health status (1 = healthy, 0 = unhealthy)
# TYPE bridge_api_healthy gauge
bridge_api_healthy{status="${health.status}"} ${health.status === 'healthy' ? 1 : 0}

# HELP bridge_api_funding_wallet_configured Funding wallet configuration status
# TYPE bridge_api_funding_wallet_configured gauge
bridge_api_funding_wallet_configured ${health.fundingWalletConfigured ? 1 : 0}

# HELP bridge_api_active_sessions Number of active bridge sessions
# TYPE bridge_api_active_sessions gauge
bridge_api_active_sessions ${health.activeSessions}

# HELP bridge_api_sessions_by_status Number of sessions by status
# TYPE bridge_api_sessions_by_status gauge
bridge_api_sessions_by_status{status="pending"} ${sessions.sessions.filter(s => s.status === 'pending_deposit').length}
bridge_api_sessions_by_status{status="processing"} ${sessions.sessions.filter(s => s.status === 'processing').length}
bridge_api_sessions_by_status{status="completed"} ${sessions.sessions.filter(s => s.status === 'completed').length}
bridge_api_sessions_by_status{status="failed"} ${sessions.sessions.filter(s => s.status === 'failed').length}
  `.trim();
  
  res.set('Content-Type', 'text/plain');
  res.send(metrics);
});
```

### Docker Health Check

Add to your Dockerfile:

```dockerfile
HEALTHCHECK --interval=30s --timeout=5s --start-period=10s --retries=3 \
  CMD curl -f https://stable-flow-backend.onrender.com/health || exit 1
```

### GitHub Actions Deployment Check

```yaml
- name: Check API Health
  run: |
    response=$(curl -s http://your-api-url/health)
    status=$(echo $response | jq -r '.status')
    
    if [ "$status" != "healthy" ]; then
      echo "API is not healthy!"
      exit 1
    fi
    
    configured=$(echo $response | jq -r '.fundingWalletConfigured')
    if [ "$configured" != "true" ]; then
      echo "Warning: Funding wallet not configured"
    fi
```

## Response Time Benchmarks

Expected response times:

| Condition | Response Time |
|-----------|---------------|
| Normal load | < 100ms |
| High load (100+ sessions) | < 500ms |
| Server under stress | < 1s |

<Warning>
  If the health endpoint takes > 5 seconds to respond, investigate immediately. This could indicate:
  - Server overload
  - Memory issues
  - Network problems
  - Database connection issues (if implemented)
</Warning>

## Debugging with Health Check

```bash
# Quick health check with formatted output
curl -s https://stable-flow-backend.onrender.com/health | jq

# Check and extract specific field
curl -s https://stable-flow-backend.onrender.com/health | jq -r '.status'

# Check if funding wallet is configured
if [ "$(curl -s https://stable-flow-backend.onrender.com/health | jq -r '.fundingWalletConfigured')" != "true" ]; then
  echo "Funding wallet not configured!"
fi

# Watch health status continuously
watch -n 5 'curl -s https://stable-flow-backend.onrender.com/health | jq'
```

## See Also

- [List Sessions](/api-reference/endpoint/list-sessions) - Get detailed session information
- [Quickstart](/quickstart) - Get started with the API